package SQL;

import java.sql.SQLException;


public class SQLConnexion extends SQL{
	
	

	public SQLConnexion() {
		super();
	}

	public static boolean validerId(String id_Utilisateur) throws SQLException {
		
	        try {
	            setStatement( getConnexion().createStatement() );
	        } catch ( SQLException e ) {
	            System.out.println( "Erreur dans la création du statement" );
	            e.printStackTrace();
	        }
	        try {
	            setResultat(getStatement().executeQuery( "SELECT COUNT(*) FROM Utilisateur WHERE id_Utilisateur = '" + id_Utilisateur + "';" ));
	            getResultat().next();
		        int resultat = getResultat().getInt(1);
		        return resultat == 1;
	        } catch ( SQLException e ) {
	            System.out.println( "Erreur dans l'execution de la requete SQL" );
	            e.printStackTrace();
	        }finally{
	        	getResultat().close();
	        }
	        return false;
	}

	public static boolean validerMotPasse(String id_Utilisateur, String motDePasse) throws SQLException {
			try {
	            setStatement( getConnexion().createStatement() );
	        } catch ( SQLException e ) {
	            System.out.println( "Erreur dans la création du statement" );
	            e.printStackTrace();
	        }
	        try {
	            setResultat(getStatement().executeQuery( "SELECT motdepasse FROM Utilisateur WHERE id_Utilisateur = '" + id_Utilisateur + "';" ));
		        getResultat().next();
		        String resultat = getResultat().getString(1);
		        return resultat == motDePasse;
	        } catch ( SQLException e ) {
	            System.out.println( "Erreur dans l'execution de la requete SQL" );
	            e.printStackTrace();
	        }finally{
	        	getResultat().close();
	        }
	        return false;

	}

	public static String recupererIdUtilisateur(String id_Utilisateur) throws SQLException {
		 try {
	            setStatement( getConnexion().createStatement() );
	        } catch ( SQLException e ) {
	            System.out.println( "Erreur dans la création du statement" );
	            e.printStackTrace();
	        }
	        try {
	            setResultat(getStatement()
	                    .executeQuery( "SELECT id_Utilisateur FROM Utilisateur WHERE id_Utilisateur = '" + id_Utilisateur +" ';" ));
		        getResultat().next();
		        String resultat = getResultat().getString(1);
		        return resultat;
	        } catch ( SQLException e ) {
	            System.out.println( "Erreur dans l'execution de la requete SQL" );
	            e.printStackTrace();
	        }finally{
	        	getResultat().close();
	        }
	        return null;
	}

}
